<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <title>ICCH Bullettin</title>
        <link rel="stylesheet" type="text/css" href="style.css">
        <link rel="stylesheet" type="text/css" href="fonts/fontawesome/css/font-awesome.min.css">
        <script src="lib/moment-with-locales.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="lib/remarkable.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="js/vue.js"></script>
        <script src="js/vue-fa-calendar.js"></script>
        <script src="js/vue-color.min.js"></script>
    </head>
    <body>
        <!-- begin of facebook sdk -->
        <script>
          window.fbAsyncInit = function() {
            FB.init({
              appId      : '1866817903604683',
              xfbml      : true,
              version    : 'v2.8'
            });
            FB.AppEvents.logPageView();
          };

          (function(d, s, id){
             var js, fjs = d.getElementsByTagName(s)[0];
             if (d.getElementById(id)) {return;}
             js = d.createElement(s); js.id = id;
             js.src = "//connect.facebook.net/en_US/sdk.js";
             fjs.parentNode.insertBefore(js, fjs);
           }(document, 'script', 'facebook-jssdk'));
        </script>
        <!-- end of facebook sdk -->
        <div id="messageToasts" v-if="messages.length">
            <div v-for="message in messages" v-bind:class="'messageToast ' + message.type + ' show-' + message.display">
                {{ message.text }}
            </div>
        </div>
        <div id="inputDialog" v-if="show">
            <div class="textbox" v-if="type === 'textbox'">
                <textarea v-model="data"></textarea>
            </div>
            <div class="readingpicker" v-if="type === 'readingpicker'">
                <input type="text" class="reading" v-model:value="data"></input>
                <ul>
                    <li v-on:click="selectSuggestion(suggestion.short)" v-for="suggestion in dataSuggestions">{{ suggestion.short }} <span class="hint">({{ suggestion.long }})</span></li>
                </ul>
            </div>
            <div class="sundaypicker" v-if="type === 'sundaypicker'">
                <input type="text" class="sunday-label" v-bind:value="data"></input>
                <button v-on:click="decreaseData(7)" class="prev">&larr;</button>
                <button v-on:click="increaseData(7)" class="next">&rarr;</button>
            </div>
            <div class="daypicker" v-if="type === 'daypicker'">
                <fa-month-table 
                    date-format="x"
                    v-on:dateclicked="okDay"
                    v-bind:month-date="data"></fa-month-table>
            </div>

            <button v-if="type !== 'daypicker'" v-on:click="ok">Ok</button>
            <button v-on:click="cancel">Cancel</button>
        </div>
        <div id="app">
            <ul id="toolBar" class="noselect hideinprint">
                <li class="tabs">
                    <ul>
                        <li v-bind:class="{ selected: toolbar.current === 'color' }"
                            v-on:click="selectTab('color')">Color</li>
                        <li v-bind:class="{ selected: toolbar.current === 'font' }"
                            v-on:click="selectTab('font')">Font</li>
                        <li v-bind:class="{ selected: toolbar.current === 'image' }"
                            v-on:click="selectTab('image')">Image</li>
                        <li v-bind:class="{ selected: toolbar.current === 'tools' }"
                            v-on:click="selectTab('tools')">Tools</li>
                    </ul>
                </li>
                <li v-if="toolbar.current === 'color'">
                    <ul>
                        <li><span class="fa fa-paint-brush" /></li>
                        <li>
                            <slider-picker v-model="colors" v-on:change-color="updateColor1"></slider-picker>
                        </li>
                        <li><span class="fa fa-font" /></li>
                        <li>
                            <slider-picker v-model="colors" v-on:change-color="updateColor2"></slider-picker>
                        </li>
                        <li>
                            Theme:
                            <span v-for="theme in Object.keys(themes)"
                                class="theme btn"
                                v-on:click="setTheme(theme)"
                                v-bind:style="{ 
                                    border: '1px solid ' + themes[theme].border,
                                    background: themes[theme].color1, 
                                    color: themes[theme].color2 }"
                                >{{theme}}</span>
                        </li>
                    </ul>
                </li>
                <li v-if="toolbar.current === 'font'">
                    <ul>
                        <li><span class="fa fa-font">&nbsp;</span>
                            <select v-model="bullettin.fonts.text.family">
                                <option value="Verdana">Verdana</option>
                                <option value="Tahoma">Tahoma</option>
                                <option value="Georgia">Georgia</option>
                                <option value="Times New Roman">Times New Roman</option>
                                <option value="Serif">Serif</option>
                                <option value="Sans-Serif">Sans-Serif</option>
                            </select>
                            <span class="sizeBox">
                                {{ bullettin.fonts.text.size }}pt
                            </span>
                            <span v-on:click="decreaseFontSize" class="btn fa fa-minus"></span>
                            <span v-on:click="increaseFontSize" class="btn fa fa-plus"></span>
                        </li>
                        <li><span class="fa fa-text-height">&nbsp;</span>
                            <span class="sizeBox">
                                {{ bullettin.fonts.text.lineHeight }}
                            </span>
                            <span v-on:click="decreaseLineHeight" class="btn fa fa-minus"></span>
                            <span v-on:click="increaseLineHeight" class="btn fa fa-plus"></span>
                        </li>
                    </ul>
                </li>
                <li v-if="toolbar.current === 'image'">
                    <ul>
                        <li>
                            <span class="fa fa-picture-o"></span>
                            <button v-on:click="toggleImage">Switch</button>
                        </li>
                        <li>
                            <span class="fa fa-expand" style="border: 1px solid white; padding: 1px;"></span>
                            <span v-on:click="increaseImageWidth" class="btn fa fa-minus"></span>
                            <span v-on:click="decreaseImageWidth" class="btn fa fa-plus"></span>
                        </li>
                    </ul>
                </li>
                <li v-if="toolbar.current === 'tools'">
                    <ul>
                        <li>
                            <span class="fa fa-calendar"></span>
                            <button v-on:click="addAppointment"><span class="fa fa-plus"></span></button>
                        </li>
                        <li>
                            <span class="fa fa-magic"></span>
                            <button v-on:click="updateReadingFromSunday()">Readings</button>
                            <button v-on:click="updateTitleFromSunday()">Title</button>
                            <button v-on:click="updateThemeFromSunday()">Theme</button>
                        </li>
                        <li>
                            Publish:
                            <input class="publishPassword" v-model="bullettin.password" placeholder="Pass" type="password"></input>
                            <button v-on:click="publishBullettin"><span class="fa fa-check"></span></button>
                        </li>
                    </ul>
                </li>
            </ul>
            <div class="address">
                <h1>ICCH</h1>
                <h2>International Catholic Community of Heidelberg</h2>
                <ul>
                    <li>St. Michael's Church</li>
                    <li>Kirschgartenstr. 35, 69126 Heidelberg Sudstadt</li>
                    <li>06221/13020 â€“ office Fr. Christof Heimpel</li>
                </ul>
            </div>
            <div class="readings">
                <h1>Today's readings:</h1>
                <p class="ref">
                    <span class="action" v-on:click="showInput('readingpicker', 'bullettin.reading1')">{{ bullettin.reading1 }}</span> |
                    <span class="action" v-on:click="showInput('readingpicker', 'bullettin.reading2')">{{ bullettin.reading2 }}</span> |
                    <span class="action" v-on:click="showInput('readingpicker', 'bullettin.reading3')">{{ bullettin.reading3 }}</span>
                <p class="welcome action" v-on:click="showInput('textbox', 'bullettin.father')">{{ bullettin.father }}</p>
            </div>
            <h1 class="title" v-bind:style="{
                    color: bullettin.colors.color2, 
                    border: '1px solid ' + bullettin.colors.border,
                    'background-color': bullettin.colors.color1 
                }">
                <span class="action" v-on:click="showInput('sundaypicker', 'bullettin.date')">{{ bullettin.date }}</span> &ndash; <span class="action" v-on:click="showInput('textbox', 'bullettin.title')">{{ bullettin.title }}</span>
            </h1>
            <img v-if="bullettin.image.enabled"
                v-bind:class="{ image1: true, action: true, 'float-left': bullettin.image.layout === 'left', 'float-right': bullettin.image.layout === 'right' }"
                v-on:click="showInput('textbox', 'bullettin.image.src')"
                v-bind:src="bullettin.image.src"
                v-bind:style="{ width: bullettin.image.size + '%' }" />
            <span class="text action" v-bind:style="'line-height:' + bullettin.fonts.text.lineHeight + 'pt; font-family:' + bullettin.fonts.text.family + '; font-size:' + bullettin.fonts.text.size + 'pt'" v-on:click="showInput('textbox', 'bullettin.text')" v-html="md2html(bullettin.text)"></span>
            <div class="source action" v-on:click="showInput('textbox', 'bullettin.source')">Source: {{ bullettin.source }}</div>
            <div v-if="bullettin.appointments.length" section class="page-footer">
                <h2 class="subtitle" v-bind:style="{ 
                    color: bullettin.colors.color2,
                    'background-color': bullettin.colors.color1,
                    border: '1px solid ' + bullettin.colors.border
                }">NEWS</h2>
                <div class="hideinprint">
                    <button v-on:click="addAppointment"><span class="fa fa-plus"> Add</span></button>
                    <button v-on:click="sortAppointments()">
                        <span class="fa fa-sort"> Sort</span>
                    </button>
                    <button v-on:click="deleteAllAppointments()">
                        <span class="fa fa-trash-o"> Delete all</span>
                    </button>
                </div>
                <ul class="info">
                    <li v-for="appointment in bullettin.appointments">
                        <button v-on:click="deleteAppointment(appointment)" class="hideinprint fa-trash-o fa"></button>
                        <button v-on:click="moveAppointmentUp(appointment)" class="hideinprint fa fa-arrow-up"></button>
                        <button v-on:click="moveAppointmentDown(appointment)" class="hideinprint fa fa-arrow-down"></button>
                        <span class="action" v-on:click="showInput('daypicker', 'epoch', appointment)">{{ appointment.date }}</span> &dash;
                        <span class="action" v-on:click="showInput('textbox', 'description', appointment)">{{ appointment.description }}</span>
                    </li>
                </ul>
                <ul class="footer">
                    <li>If you would like to be added to our email list please send your contact information to:</li>
                    <li><a href="mailto:infoheidelberg@internationalcatholiccommunity.com">infoheidelberg@internationalcatholiccommunity.com</a></li>
                </ul>
            </div>
            <ul v-else class="footer">
                <li>If you would like to be added to our email list please send your contact information to:</li>
                <li><a href="mailto:infoheidelberg@internationalcatholiccommunity.com">infoheidelberg@internationalcatholiccommunity.com</a></li>
            </ul>
        </div>
        <script src="js/main.js"></script>
    </body>
</html>
